<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hybrid Spares Shop</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<style>
/* ---------- GLOBAL ---------- */
* { box-sizing:border-box; margin:0; padding:0; font-family:Poppins, Arial, sans-serif; }
body { background:#1B1B1B; color:#ECF0F1; font-weight:bold; }

/* ---------- HEADER / NAVBAR ---------- */
.site-header { display:flex; justify-content:space-between; align-items:center; background:#2C2F2F; color:#ECF0F1; padding:15px 20px; position:sticky; top:0; z-index:1000; }
nav a, nav button { color:#ECF0F1; background:none; border:none; margin-left:15px; cursor:pointer; font-weight:bold; }
nav a.active { color:#E67E22; border-bottom:2px solid #ECF0F1; }
.logo-container { display:flex; align-items:center; }
.logo { height:80px; display:block; margin-right:10px; }
.menu-toggle { display:none; font-size:22px; color:#ECF0F1; background:none; border:none; }
@media(max-width:768px){ 
  nav { display:none; flex-direction:column; background:#111; position:absolute; top:100%; left:0; right:0; } 
  nav.open { display:flex; } 
  .menu-toggle { display:block; } 
  nav a, nav button { padding:15px; border-top:1px solid #333; } 
}

/* ---------- HERO ---------- */
.hero { height:400px; position:relative; display:flex; align-items:center; justify-content:center; color:#ECF0F1; text-align:center; overflow:hidden; z-index:1; background:#111; }
.hero.hidden-section { display:none !important; }
.slideshow, .slide { position:absolute; inset:0; }
.slide { background-size:cover; height:400px; background-position:center; opacity:0; transition:opacity 0.2s; }
.slide.active { opacity:1; }
.hero-content { position:relative; z-index:2; }
.cta-btn { padding:10px 20px; background:#E67E22; color:#ECF0F1; border:none; border-radius:5px; cursor:pointer; margin-top:5px; }
.cta-btn:hover { background:#D35400; }

/* ---------- SECTIONS ---------- */
section { padding:40px 20px; max-width:1200px; margin:auto; background:#1E1E1E; color:#ECF0F1; font-weight:bold; }
.product-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:20px; }
.product { background:#2C2F2F; padding:15px; border-radius:8px; text-align:center; box-shadow:0 4px 8px rgba(0,0,0,.3); color:#ECF0F1; font-weight:bold; }
.product h3, .product p, .product small { color:#ECF0F1; }
.ask-expert-btn { margin-top:6px; width:100%; background:#111; color:#E67E22; border:1px solid #E67E22; padding:8px; font-size:12px; cursor:pointer; border-radius:5px; }
.ask-expert-btn:hover { background:#2C2F2F; border-color:#D35400; color:#D35400; }

/* ---------- CART ---------- */
#cart-count { background:#E67E22; padding:2px 6px; border-radius:50%; font-size:12px; }

/* ---------- FOOTER ---------- */
footer { text-align:center; padding:20px; background:#111; color:#D35400; }

/* ---------- ADMIN MODAL ---------- */
.modal { position:fixed; inset:0; background:rgba(0,0,0,.8); display:flex; align-items:center; justify-content:center; z-index:2000; }
.modal-content { background:#2C2F2F; padding:20px; width:90%; max-width:500px; border-radius:8px; max-height:90vh; overflow:auto; color:#ECF0F1; }
.close { float:right; font-size:24px; cursor:pointer; color:#E67E22; }

/* ---------- KIMANI CHATBOT ---------- */
#kimani-chat { position:fixed; bottom:20px; right:20px; width:250px; background:#2C2F2F; border:2px solid #E67E22; border-radius:10px; padding:10px; color:#ECF0F1; font-size:13px; z-index:2000; display:flex; flex-direction:column; align-items:center; }
#kimani-chat .avatar { font-size:50px; color:#E67E22; margin-bottom:5px; animation: bounce 1s infinite; }
#chat-history { background:#111; color:#ECF0F1; border-radius:8px; padding:10px; width:100%; height:150px; overflow-y:auto; margin-bottom:5px; font-size:13px; }
.message { margin-bottom:5px; }
.user-msg { text-align:right; color:#D35400; }
.ai-msg { text-align:left; color:#E67E22; }
#chat-input { width:100%; padding:6px; border-radius:5px; border:none; margin-bottom:5px; }
#chat-send { width:100%; padding:6px; border:none; background:#E67E22; color:#ECF0F1; border-radius:5px; cursor:pointer; }
#chat-send:hover { background:#D35400; }

/* ---------- TYPING ANIMATION ---------- */
.typing-dots { display:inline-block; width:20px; text-align:center; }
.typing-dots span { display:inline-block; width:4px; height:4px; margin:0 1px; background:#E67E22; border-radius:50%; animation:blink 1.4s infinite both; }
.typing-dots span:nth-child(2) { animation-delay:.2s; }
.typing-dots span:nth-child(3) { animation-delay:.4s; }
@keyframes blink { 0%,80%,100% { opacity:0; } 40% { opacity:1; } }
@keyframes bounce { 0%,100%{transform:translateY(0);}50%{transform:translateY(-5px);} }

</style>
</head>
<body>

<!-- HEADER -->
<header class="site-header">
  <div class="logo-container">
    <img src="images/logo.png" class="logo" alt="Hybrid Centre Logo">
    <h2>HYBRID CENTRE</h2>
  </div>
  <button class="menu-toggle" id="menuToggle"><i class="fa fa-bars"></i></button>
  <nav>
      <a href="#home" class="nav-link">Home</a>
      <a href="#products" class="nav-link">Products</a>
      <a href="#cart" class="nav-link">Cart (<span id="cart-count">0</span>)</a>
      <a href="#payment" class="nav-link">Payment</a>
      <a href="#location" class="nav-link">Location</a>
      <a href="#contact" class="nav-link">Contact</a>
      <button id="adminLoginBtn">Admin</button>
  </nav>
</header>

<!-- HERO -->
<section class="hero" id="home">
  <div class="slideshow">
    <div class="slide active" style="background-image:url('images/hero1.png')"></div>
    <div class="slide" style="background-image:url('images/hero2.png')"></div>
    <div class="slide" style="background-image:url('images/hero3.png')"></div>
    <div class="slide" style="background-image:url('images/hero4.png')"></div>
  </div>
  <div class="hero-content">
    <h1>Hybrid Vehicle Spares</h1>
    <p>Quality • Batteries • Modules</p>
    <button class="cta-btn" id="bookServiceBtn">Shop Now</button>
  </div>
</section>

<!-- PRODUCTS -->
<section id="products" class="page hidden-section">
  <h2>Our Products</h2>
  <div id="product-list" class="product-grid"></div>
</section>

<!-- CART -->
<section id="cart" class="page hidden-section">
<h2>Your Cart</h2>
<div id="cart-items"></div>
<h3 id="cart-total">Total: 0</h3>
<button class="cta-btn" id="checkoutPaybill">Checkout via Paybill</button>
<button class="cta-btn" id="waOrder">Order via WhatsApp</button>
<div id="paybill-info" class="hidden-section">
<h4>Pay via M-Pesa Paybill</h4>
<ul>
<li>Paybill Number: <strong>222111</strong></li>
<li>Account Number: <strong>5825469</strong></li>
<li>Business Name: <strong>Hybrid Centre</strong></li>
</ul>
<button class="cta-btn" id="confirmPaymentBtn">Send Confirmation via WhatsApp</button>
</div>
</section>

<!-- PAYMENT -->
<section id="payment" class="page hidden-section">
<h2>Payment</h2>
<p>Via M-Pesa Paybill</p>
<button class="cta-btn" id="stkBtn">STK Push (Coming Soon)</button>
</section>

<!-- LOCATION -->
<section id="location" class="page hidden-section">
<h2>Location</h2>
<p>Kirinyaga Road, behind Indian Mosque, Grogon Lane, Nairobi</p>
<iframe width="100%" height="300" src="https://www.google.com/maps?q=Kirinyaga+Road+behind+Indian+Mosque+Grogon+Lane+Nairobi&output=embed"></iframe>
</section>

<!-- CONTACT -->
<section id="contact" class="page hidden-section">
<h2>Contact</h2>
<p>Call: <a href="tel:+254780328599">+254 780 328 599</a></p>
<p>WhatsApp: <a href="https://wa.me/254780328599" target="_blank">Chat</a></p>
</section>

<!-- ADMIN DASHBOARD -->
<div class="modal hidden" id="adminModal">
<div class="modal-content">
<span class="close" id="closeAdmin">&times;</span>
<h3>Inventory Manager</h3>
<input id="pname" placeholder="Product name">
<input id="pprice" type="number" placeholder="Price">
<input id="ptags" placeholder="Tags (optional)">
<button id="addProductBtn">Add Product</button>
<h4>Current Inventory:</h4>
<ul id="admin-list"></ul>
</div>
</div>

<!-- KIMANI CHATBOT -->
<div id="kimani-chat">
  <i class="fa-solid fa-user-gear avatar"></i>
  <div id="chat-history">Hi! I’m Kimani, your hybrid mechanic. Ask me anything!</div>
  <input type="text" id="chat-input" placeholder="Type your question...">
  <button id="chat-send">Send</button>
</div>

<footer>&copy; 2025 Hybrid Spares Shop</footer>

<script>
// ---------- SPA NAVIGATION ----------
const hero=document.querySelector(".hero");
const pages=document.querySelectorAll(".page");
const navLinks=document.querySelectorAll(".nav-link");
function showPage(id){
  pages.forEach(p=>p.classList.add("hidden-section"));
  if(id!="#home"){ hero.classList.add("hidden-section"); document.querySelector(id)?.classList.remove("hidden-section"); }
  else hero.classList.remove("hidden-section");
  navLinks.forEach(l=>l.classList.remove("active"));
  document.querySelector(`a[href="${id}"]`)?.classList.add("active");
  history.pushState(null,"",id);
}
navLinks.forEach(l=>l.addEventListener("click", e=>{ e.preventDefault(); showPage(l.getAttribute("href")); document.querySelector("nav").classList.remove("open"); }));
document.getElementById("menuToggle").onclick=()=>document.querySelector("nav").classList.toggle("open");
document.getElementById("bookServiceBtn").onclick=()=>showPage("#products");

// ---------- HERO SLIDESHOW ----------
const slides=document.querySelectorAll(".slide");let s=0;
setInterval(()=>{if(!hero.classList.contains("hidden-section")){slides.forEach(sl=>sl.classList.remove("active")); s=(s+1)%slides.length; slides[s].classList.add("active");}},5000);

// ---------- PRODUCTS ----------
let products=[
  {id:1,name:"Hybrid Battery Modules",price:500,tags:"battery module",stock:true},
  {id:2,name:"Inverter & Power Control Unit",price:400,tags:"inverter",stock:true},
  {id:3,name:"Cooling Fans & Pumps",price:200,tags:"cooling fan",stock:true}
];
function saveProducts(){localStorage.setItem("products",JSON.stringify(products));}
function renderProducts(){
  const list=document.getElementById("product-list"); list.innerHTML="";
  products.forEach(p=>{
    list.innerHTML+=`<div class="product" style="opacity:${p.stock?1:.4}">
      <h3>${p.name}</h3>
      <p>KES ${p.price}</p>
      <small>${p.stock?"In Stock":"Out of Stock"}</small>
      <button class="cta-btn" ${!p.stock?"disabled":""} onclick="addToCart('${p.name}',${p.price})">Add to Cart</button>
      <button class="ask-expert-btn" onclick="expert('${p.tags}')">Ask Expert</button>
    </div>`;
  });
}
renderProducts();

// ---------- ADMIN DASHBOARD ----------
const modal=document.getElementById("adminModal");
const adminBtn=document.getElementById("adminLoginBtn");
const closeAdmin=document.getElementById("closeAdmin");
if(adminBtn && modal) adminBtn.onclick=()=>modal.classList.remove("hidden");
if(closeAdmin && modal) closeAdmin.onclick=()=>modal.classList.add("hidden");

function renderAdmin(){
  const list=document.getElementById("admin-list"); list.innerHTML="";
  products.forEach(p=>{
    list.innerHTML+=`<li>${p.name} - ${p.stock?"IN":"OUT"} 
    <button onclick="toggleStock(${p.id})">Toggle</button></li>`;
  });
}
function addProduct(){
  const name=document.getElementById("pname").value;
  const price=+document.getElementById("pprice").value;
  const tags=document.getElementById("ptags").value;
  if(!name||!price) return alert("Name & Price required");
  products.push({id:Date.now(),name,price,tags,stock:true});
  saveProducts(); renderProducts(); renderAdmin();
  document.getElementById("pname").value=""; document.getElementById("pprice").value=""; document.getElementById("ptags").value="";
}
function toggleStock(id){ const p=products.find(x=>x.id===id); p.stock=!p.stock; saveProducts(); renderProducts(); renderAdmin(); }
renderAdmin();
document.getElementById("addProductBtn").onclick=addProduct;

// ---------- CART ----------
let cart=[];
function addToCart(name,price){ cart.push({name,price}); updateCart(); showPage("#cart"); }
function updateCart(){ const cartItems=document.getElementById("cart-items"); let total=0; cartItems.innerHTML=""; cart.forEach(item=>{ cartItems.innerHTML+=`${item.name} - KES ${item.price}<br>`; total+=item.price; }); document.getElementById("cart-count").textContent=cart.length; document.getElementById("cart-total").textContent=`Total: KES ${total}`; }
document.getElementById("checkoutPaybill").onclick=()=>{if(cart.length===0)return alert("Cart empty"); document.getElementById("paybill-info").classList.remove("hidden-section"); };
document.getElementById("confirmPaymentBtn").onclick=()=>{
  if(cart.length===0)return alert("Cart empty");
  let msg="Payment Confirmation for Order:%0A"; let total=0;
  cart.forEach(i=>{ msg+=`${i.name} - KES ${i.price}%0A`; total+=i.price; });
  msg+=`Total Paid: KES ${total}`;
  window.open(`https://wa.me/254780328599?text=${msg}`);
};
document.getElementById("waOrder").onclick=()=>{
  if(cart.length===0)return alert("Cart empty"); let msg="HYBRID CENTRE ORDER%0A-----------------%0A"; let total=0;
  cart.forEach(i=>{ msg+=`${i.name} - KES ${i.price}%0A`; total+=i.price; });
  msg+=`-----------------%0ATOTAL: KES ${total}%0AVehicle: ___________%0ALocation: ___________%0A`;
  window.open(`https://wa.me/254780328599?text=${msg}`);
};
document.getElementById("stkBtn").onclick=()=>alert("STK Push coming soon!");

// ---------- KIMANI CHATBOT ----------
const chatHistory=document.getElementById("chat-history");
const chatInput=document.getElementById("chat-input");
const chatSend=document.getElementById("chat-send");

function addMessage(text,sender){
  const div=document.createElement("div");
  div.classList.add("message", sender==="user"?"user-msg":"ai-msg");
  div.innerHTML=text;
  chatHistory.appendChild(div);
  chatHistory.scrollTop=chatHistory.scrollHeight;
}

function kimaniReply(input){
  input=input.toLowerCase();
  if(input.includes("hello")||input.includes("hi")) return "Hey there! Kimani here, ready to help with your hybrid vehicle.";
  if(input.includes("battery")) return "Check your hybrid battery connections and charge! Need step-by-step guidance?";
  if(input.includes("cooling")) return "Check cooling fans and coolant levels. I can guide you through it.";
  if(input.includes("price")) return "All part prices are listed on the Products page. You can also ask me about stock availability.";
